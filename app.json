{
    "extends":[
        "github>mailerlite/renovate-config:base"
    ],
    "enabledManagers":[
        "regex",
        "docker-compose",
        "helmv3",
        "github-actions"
    ],
    "regexManagers":[
        {
            "fileMatch":["(^|\/|.)Dockerfile$"],
            "matchStrings":[
                "# renovate: datasource=(?<datasource>.*?) depName=(?<depName>.*?)( extractVersion=(?<extractVersion>.+?))?( versioning=(?<versioning>.*?))?\n.*?_VERSION=[\"]?(?<currentValue>.*[^\"\\n])"
            ],
            "versioningTemplate":"{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}"
        },
        {
            "fileMatch":["^Makefile$"],
            "matchStrings":[
                "OCTOPUS_IMAGE := (?:.*?\/mailergroup\/)(?<depName>.*?):(?<currentValue>.*?[a-f0-9].*)"
            ],
            "datasourceTemplate":"docker"
        },
        {
            "fileMatch":["(^|\/|.)Dockerfile$"],
            "matchStrings":[
                "FROM (?:.*?\/mailergroup\/)(?<depName>[a-z0-9.\/-]+)(?::(?<currentValue>[a-z0-9.-]+))?"
            ],
            "datasourceTemplate":"docker"
        },
        {
            "fileMatch":["(?:helm|helmchart)/values.(?:dev|prod|staging|production).(?:yaml|yml)"],
            "matchStrings":[
                "# renovate: datasource=(?<datasource>.*?) depName=(?<depName>.*?)?\n.*?image: .*?:(?<currentValue>.*)"
            ],
            "versioningTemplate":"{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}"
        }
    ],
    "packageRules":[
        {
            "matchPackagePatterns":[
                "octopus",
                "swiss-army-knife"
            ],
            "registryUrls":["https://europe-docker.pkg.dev/mailergroup/"]
        },
        {
            "matchPackagePatterns":["europe-docker.pkg.dev/mailerlite-v2/landings/landings"],
            "registryUrls":["https://europe-docker.pkg.dev/mailerlite-v2/"]
        },
        {
            "matchPackagePatterns":["europe-docker.pkg.dev/mailergroup/groot/groot"],
            "registryUrls":["https://europe-docker.pkg.dev/mailergroup/"]
        },
        {
            "matchPackageNames":["europe-docker.pkg.dev/mailerlitehub/groot/groot"],
            "registryUrls":["https://europe-docker.pkg.dev/mailerlitehub/"]
        },
        {
            "matchDatasources":["docker"],
            "addLabels":["docker"],
            "reviewers":["team:sre"],
            "schedule": ["before 2am", "after 11pm"]
        },
        {
            "matchDatasources":["github-actions"],
            "addLabels":["github"],
            "reviewers":["team:sre"],
            "schedule": ["before 3am", "after 10pm"]
        },
        {
            "matchPackagePatterns":["elasticsearch"],
            "matchUpdateTypes":["patch","minor"]
        },
        {
            "matchPackagePatterns":["elasticsearch"],
            "matchUpdateTypes":["major"],
            "enabled":false
        },
        {
            "matchPackagePatterns":["groot"],
            "addLabels":["groot"]
        },
        {
            "matchPackageNames":["europe-docker.pkg.dev/mailerlitehub/groot/groot"],
            "automerge": true,
            "automergeType": "pr",
            "addLabels":["groot", "automerge"],
            "schedule": ["every 1 hour"],
            "prPriority": -1
        },
        {
            "matchDatasources":["helm"],
            "addLabels":["helm"],
            "reviewers":["team:sre"],
            "schedule": ["before 4am", "after 9pm"]
        },
        {
            "matchDatasources":["github-releases"],
            "reviewers":["team:sre"],
            "schedule": ["before 5am", "after 8pm"]
        }
    ]
}
